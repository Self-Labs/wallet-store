{% extends "admin/base_site.html" %}
{% load i18n static %}

{% block bodyclass %}{{ block.super }} login-page{% endblock %}
{% block usertools %}{% endblock %}
{% block nav-global %}{% endblock %}
{% block nav-sidebar %}{% endblock %}
{% block content_title %}{% endblock %}
{% block breadcrumbs %}{% endblock %}
{% block header %}{% endblock %}

{% block extrastyle %}
{{ block.super }}
<style>
    /* --- RESET NUCLEAR --- */
    html, body {
        height: 100% !important;
        width: 100% !important;
        margin: 0 !important;
        padding: 0 !important;
        overflow: hidden !important;
    }

    /* Fundo Cyberpunk */
    body.login-page {
        background-color: var(--bg-dark) !important;
        background-image: radial-gradient(circle at center, #111 0%, #050505 100%) !important;
        font-family: 'Inter', monospace !important;
    }

    /* Neutraliza containers do Django */
    #container, #content, #content-main {
        width: 100% !important;
        height: 100% !important;
        margin: 0 !important;
        padding: 0 !important;
        border: none !important;
        background: transparent !important;
    }

    /* --- Login Card --- */
    .login-box {
        position: fixed !important; /* Fixa na janela do navegador */
        top: 50% !important;        /* Empurra 50% para baixo */
        left: 50% !important;       /* Empurra 50% para direita */
        transform: translate(-50%, -50%) !important; /* Puxa de volta para o centro exato */
        
        width: 100%;
        max-width: 380px;
        background-color: var(--bg-card);
        border: 1px solid var(--border);
        padding: 2.5rem;
        box-sizing: border-box;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.9);
        z-index: 9999; /* Garante que fique acima de tudo */
    }

    /* --- Barra Verde Neon --- */
    .login-box::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 4px;
        background-color: var(--primary);
        box-shadow: 0 0 10px var(--primary); /* Efeito brilho extra */
    }

    /* --- Ícone de Cadeado --- */
    .icon-container {
        display: flex;
        justify-content: center;
        margin-bottom: 2rem;
    }
    .icon-box {
        background-color: #111;
        padding: 1rem;
        border: 1px solid var(--border);
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 4px;
    }
    .lock-icon {
        width: 32px;
        height: 32px;
        color: var(--primary);
    }

    /* --- Tipografia --- */
    h1 {
        font-family: 'Rigid Square', sans-serif !important;
        font-size: 1.5rem !important;
        font-weight: bold !important;
        text-align: center;
        color: white !important;
        margin: 0 0 0.5rem 0 !important;
        letter-spacing: 0.2em !important;
        text-transform: uppercase;
    }
    .subtitle {
        text-align: center;
        color: #4b5563;
        font-size: 0.65rem;
        margin: 0 0 2rem 0;
        text-transform: uppercase;
        letter-spacing: 1px;
        font-weight: 600;
    }

    /* --- Formulário --- */
    .form-row {
        margin-bottom: 1.25rem;
    }
    .form-row label {
        display: block;
        color: var(--primary);
        font-size: 0.75rem;
        text-transform: uppercase;
        margin-bottom: 0.4rem;
        font-weight: bold;
    }
    
    /* Estilo dos Inputs */
    .form-row input {
        width: 100%;
        background-color: #050505 !important;
        border: 1px solid var(--border) !important;
        padding: 0.75rem !important;
        color: white !important;
        font-family: monospace !important;
        box-sizing: border-box !important;
        transition: all 0.2s;
        border-radius: 0 !important; /* Design quadrado */
        height: auto !important;
    }
    .form-row input:focus {
        border-color: var(--primary) !important;
        outline: none;
        box-shadow: 0 0 8px rgba(0, 255, 163, 0.2);
    }
    .form-row input::placeholder {
        color: #333;
    }

    /* --- Botão de Login --- */
    .submit-row {
        margin-top: 1.5rem;
        padding: 0 !important;
        text-align: center !important;
    }
    .submit-row input {
        width: 100%;
        background-color: var(--primary) !important;
        color: black !important;
        font-weight: bold !important;
        text-transform: uppercase;
        padding: 1rem !important;
        border: none !important;
        cursor: pointer;
        letter-spacing: 0.1em;
        font-size: 0.875rem !important;
        transition: transform 0.1s;
        height: auto !important;
        border-radius: 0 !important;
    }
    .submit-row input:hover {
        opacity: 0.9;
        transform: scale(0.99);
    }

    /* --- Mensagens de Erro --- */
    .errornote {
        border: 1px solid #7f1d1d;
        background-color: rgba(127, 29, 29, 0.1);
        color: #ef4444;
        font-size: 0.75rem;
        padding: 0.75rem;
        text-align: center;
        text-transform: uppercase;
        margin-bottom: 1rem;
        list-style: none;
    }
</style>
{% endblock %}

{% block content %}
<div class="login-box">
    <div class="icon-container">
        <div class="icon-box">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lock-icon"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>
        </div>
    </div>

    <h1>Store Login</h1>
    <p class="subtitle">SECURE ENVIRONMENT // RESTRICTED ACCESS</p>

    {% if form.errors and not form.non_field_errors %}
    <div class="errornote">
        ACCESS DENIED. Invalid credentials.
    </div>
    {% endif %}

    {% if form.non_field_errors %}
    {% for error in form.non_field_errors %}
    <div class="errornote">
        {{ error }}
    </div>
    {% endfor %}
    {% endif %}

    <form action="{{ app_path }}" method="post" id="login-form">{% csrf_token %}
        <div class="form-row">
            <label for="id_username">Username</label>
            {{ form.username }}
        </div>
        <div class="form-row">
            <label for="id_password">Password</label>
            {{ form.password }}
            <input type="hidden" name="next" value="{{ next }}">
        </div>
        <div class="submit-row">
            <input type="submit" value="Authenticate">
        </div>
    </form>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        var userField = document.getElementById('id_username');
        var passField = document.getElementById('id_password');
        if (userField) userField.placeholder = "USER_ID";
        if (passField) passField.placeholder = "••••••••";
    });
</script>
{% endblock %}